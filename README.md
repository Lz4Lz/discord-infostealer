I wrote this a while back, very bad and messy code. But works, might update or add functionality in the future i guess.
